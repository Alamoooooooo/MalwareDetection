# -*- coding: utf-8 -*-
"""
Created on Fri Mar 27 12:36:37 2020

@author: Lenovo
"""

import numpy, os, array
import imageio
import math

def Normalize(data):
    m = numpy.mean(data)
    mx = max(data)
    mn = min(data)
    return [(float(i) - m) / (mx - mn) for i in data]

#filename = 'D:\\AlamoWork\\Adware\\Adware\\Adware\\feiwo\\b3c7575f237a5ceed88b9a0420c1beb6.apk'
filename = 'D:/AlamoWork/Adware/test/air.beingfashiondesigner/classes.dex'
graphname = 'D:/AlamoWork/Adware/test/gtestjpg.jpg'
#graphname = 'D:/AlamoWork/Adware/test/feiwo1.jpg'

f = open(filename,'rb') # 读入文件
ln = os.path.getsize(filename) # 文件长度（byte）

length = int(math.sqrt(ln))
width = length # 生成正方形
#a = array.array("B") # uint8 数组
#bt = numpy.zeros((length*width)) #建立数组并填充0
#a = numpy.array(bt,dtype='uint8') 
a = array.array("B")

print(length,width)
print(length*width)

#rem = ln % length # 计算余出的字节 
rem = ln - (length*width) # 计算余出的字节 
a.fromfile(f,ln-rem) # 将文件读入数组a中，舍去余出的字节
f.close()

#while( < length*width):
#    a.append(0)

#g = numpy.reshape(a,(length,width)) # 将数组转为二维
#g = numpy.uint8(g)
g = numpy.uint8(a)
#imageio.imsave(graphname,g) # 保存图片
k = Normalize(g)
imageio.imsave(graphname,k) # 保存图片